## AdDKG
This repository provides the process of the construction of the Alzheimer’s disease and Dementia Knowledge Graphs (AdDKG) wlong with all the datasets and query protocols used in the work. AdDKG is a literature-based biomedical knowledge graph designed for exploring the mechanism underlying astrocyte autophagy and pyroptosis in AD. This project is done by Gongli Hospital of Shanghai Pudong New Area and Shanghai Pudong New Area Mental Health Center, P.R.. 

## Authors
Ting Liu (lt02174@glhospital.com), Zhisheng Huang (huang.zhisheng.nl@gmail.com) and Hongyun Qin (qinhongyun07@163.com)

## Datasets
The complete AdDKG integrates annotated triples from 172,283 articles, constituting a large-scale resource around 176 GB. Given the complexity of hosting and servicing such a graph-structured database on public platforms, the full knowledge base is maintained on our institutional servers via a secure access protocol. Here, to ensure the transparency and to facilitate the verification, we provide the following two access pathways:
The [datasets](https://github.com/tingcosmos/KetPath/releases/) used to construct the AdDKG knowledge graph are as follows: \
    - The core annotated data supporting the key findings from the 12 retrieved articles of the case study
    - SNOMED CT (48 MB) - consists of named biomedical vocabularies and defined relationships between terms \

## Workflow

### Retrieving articles: 

Retrieve PubMed IDs (PMIDs) for relevant articles by using the following query: https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&term="Ketamine+Depression"&RetMax=10000. Save the retrieved list of PIMDs locally in text format under the `pmid2html`-->`data`-->`pmidlist` file directory.

### Downloading articles: 

Right-click and edit the `run-PubmedDownload.bat` file located in the `pmid2html` directory. Updated the name of the PMID list file as needed, save changes, and then double-click the `run-PubmedDownload.bat` file to initiate the download of articles in HTML format.

### Manual fact curation from pathway images

(1) Manually collect hand-drawn images and free-text descriptions of the ketamine pathway from relevant publications.\
(2) Manually extract entities and relations of interest from those images and texts. \
(3) Define entities and their relations using KetFact as a domain name. \
(4) Map entities to the KEGG and UMLS databases by matching their URIs with the owl:sameAs statement. The generated dataset is stored in the `KetFact.ttl` file. 

### Named entity recognition and semantic annotation with XMedlan

Use XMedlan, a Xerox Concept Identifier (CI-er) tool, for named entity recognition and semantic annotation of biomedical text with terminologies UMLS and SNOMED CT. \
The dataset generated by XMedlan is stored in the `KetCept.zip` file.

### Knowledge graph construction in the GraphDB

**1. Downloading and starting the GraphDB** \
Download GraphDB free edition from https://www.ontotext.com/products/graphdb/graphdb-free/. GraphDB is a Java application and requires Java 8. Make sure you have an up-to-date Java 8 installation. Please download Java from https://java.com/en/download/help/download_options.xml. Run the GraphDB script in the bin directory. To access the Workbench, open http://localhost:7200 in a browser. Please get more information on GraphDB for a [quick start guide](https://graphdb.ontotext.com/documentation/10.4/index.html).

**2. Creating repositories in GraphDB** \
By default, the GraphDB will initialize a location but not create any repositories. \
Create a new repository from the menu `Setup` -> `Repositories` page in the GraphDB Workbench. \
To create a new repository in the location, click `Create new repository`. \
Fill in KetPath at the `Repository ID*`, then click `creat`.

**3. Importing databases in GraphDB** \
Import all databases from the menu `Import` -> `RDF page` -> `User data`. Click on `Upload RDF files` and select files to upload. \
Click on `Import`, and fill the Target graphs with a URL as Named graphs. \
If the database is too large to upload from the User data page, you can store the database in the local `graphdb-import` file and then import the database from the menu `Import` -> `RDF page` -> `Server files`. \
All databases are available at [KetPath Release Page](https://github.com/tingcosmos/KetPath/releases/).

**4. Accessing and reasoning data in GraphDB** \
The data in GraphDB can be accessed and reasoned by SPARQL query language. Start query from the menu `SPARQL`. \
Please find query templates in the [sparql-codes](https://github.com/tingcosmos/KetPath/blob/main/sparql-codes). Users can perform their own queries by changing the parameters in the templates. \
Use the SPARQL query endpoint of UniProt to retrieve its data without downloading the data stack. 

### Relation extraction with BioKetBERT
**1. Preparing training and testing datasets for relation extraction** \
Run the query protocol for case 1 from the 'sparql-codes.txt' file in GraphDB to retrieve sentences where 'ketamine' and 'neurotransmitter' co-occurrence. The target-named entities need to be tagged with the pre-defined tags such as @entity$ for further relation extraction tasks. For the training set, a label needs to be added indicating whether the two entities in a sentence are related: 1 for a relation, 0 otherwise. 

**2. Fine-tuning the BioBERT model and performing relation extraction** \
Fine-tune the BioBERT model and dubber the resulting model BioKetBERT. Perform relation extraction tasks withBioKetBERT according the process provided by [_Lee et al._](https://academic.oup.com/bioinformatics/article/36/4/1234/5566506) in the [BioBERT repository](https://github.com/dmis-lab/biobert). More details can be find in their paper BioBERT: a pre-trained biomedical language representation model for biomedical text mining for more details. 

The performance of the relation extraction task needs to be evaluated using five-fold cross-validation, where the dataset containing 2,143 sentences is randomly partitioned into five stratified subsets of equal size: for each round, one data block (428 sentences) is used for training and the remaining (1,715 sentences) four are for testing.

The relational dataset generated by the BioKetBERT model is stored in the `KetRela.ttl` file, which also need to be added to the `KetPath repository` in GraphDB.

## More information
Please contact Ting Liu (t.liu@vu.nl; tingliu0909@gmail.com) if you have any questions about the construction process, the datasets and query protocols.

## Citation
`@article{liu2020ketpath,
    author = {Liu, Ting and Feenstra, K Anton and Huang, Zhisheng and Heringa, Jaap},
    title = "{Mining literature, microbiome and pathway data to explore the relations of ketamine with neurotransmitters and gut microbiota using a knowledge-graph}",
    journal = {},
    year = {2023},
    volume = {},
    number = {},
    pages = {},
    publisher = {},
    doi = {},
}`
